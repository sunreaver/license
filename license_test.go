package license

import (
	"bytes"
	"io"
	"reflect"
	"strings"
	"testing"
)

var okPrivateKey = `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCT4pHk5cbrmtXc
4KWTo9uW24aBFvsO7u8Wjge2SF1/iIm0U4/NCiiLkFzzgkcJJStLfn9/AGqydg74
g6y6y8P3kPqoqYzdXdnu87ZH1sSH1LC5QjA77zV5cQuXHIx9bB/dEvp2wDyArbaJ
SX+G4Vu9sJt1BL/FFAy4f6hRQJ8eqLrPh0Y7WtG1UzKNRBda+/D+ZOoN6KlTjejV
AvZd4mLlJGv6V2zGFzf1baJ83I6/Y7pTxaGFN+DUo8EAGl4KXGYI4jhYPZxSNRy+
98hU/35IeNQEluZXB1XtNp9RIsxHrQu6hXeufL1YBcxVsvsjb9eMuF22fm9CeZEK
TD/hswK/AgMBAAECggEBAI7ZN4Y8cjaZXOW71hTUHcQOD1HYqfBV2nsV/NsV8cLE
WAfpA6nSmzGc5DyP5iAuWDDXYz6BX489PN7PCmVxeL1FvOp4xMn74wzPO48PJM30
JDT/e2oZebTx/nkcKZTpganhsDBPJuJBamYYqefW/fAwjSmuybML1/HL1gGOg2Vv
rQC2ImTwOure+BErYq7f7qcFy9AdpFCaexiu1ZvJRJKl0fUMXGuhfTAOr0wAm/9X
6IN2Kap44GqFJSePnB9oa7ddAH1/1XiX02Bb2DjeRZn8CqsgznLmYhYoOfOFrXF0
FhPBV9sn8vHTw0eZzx2XN5g9V6/QQp/xXnMekoTerXECgYEAxJqyIZBBt42S57sI
S+GQk4uASPuqFt2meWo0hBW7z7CnZj1jX7F/bPm0N9ABrbtwwA1eqaBiaGzkh9GM
g8WJuNjjr2bMIlZ0bMRTFwjNNJ0Hvf/Mq/4RJnxwuGg5hj3uqhxuuKSxcwWBUiAl
4bvmV7v3oIvr77dHtGIbwi0RLKcCgYEAwI/yCmYXFbf8Y54x1MpZBx2OfIO/Rqob
ljW20yGOWkA57GANGvSEWLElnT7hkU5XY3vpoG7+/Vn0d4QUbmrl9A7V13QmPEzD
YoRj6jBHgBA3sCbduKb7SOUQCNr+Wsp4b4VqTJPJDsO0K75fY1JQNFBPceZ8Lp/K
WzrC0UeFxCkCgYBbYT+cRA2XgBEg7hi8FDp7qaJVyctT12/yDQAdyHBD52rXJX9T
0g9VGna+Xkr5ch7E1TIDi41R1hMeYbJ66MzLgtvJAfGtoBt7FoE8OpYOd1JK6GM8
KdnU1pAZ1i+uioisvoxj/ACSYqOqBVE2K3yzmKVPFNnz0G9ekx8t0H6kDwKBgHuW
Z1QBPeO0mAofp//Ydtc4QxDrRcJGvzni85oCOWj3O7XX19FrCd4ao/eOOhuWWkQB
bWqIkqNsLpjebnaHqVrAgsKrSzb8VZJPQgk2P02UGwm1iCxRD4ozad0lIIaI2E9L
I3ROjYYqWOKSZopKdCt/N930fdM2vxtaVVsYOmQxAoGAU9LYL+YLMhLZpAKHPTh+
lJUt5YJ16ybk6NV8XNY6zkvktWwHngK8kuOLmmS7S0K6Id6UCpHJgA1nvMHf7TgH
lfrzfChXWIW9FB29/e6cqb4GARLGhDANabq9cctKc/QrWfTqAdvWav+xcrf3O3UW
AQ1O66mYqRCnaA5ytR0oOmE=
-----END PRIVATE KEY-----`
var okPubKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAk+KR5OXG65rV3OClk6Pb
ltuGgRb7Du7vFo4Htkhdf4iJtFOPzQooi5Bc84JHCSUrS35/fwBqsnYO+IOsusvD
95D6qKmM3V3Z7vO2R9bEh9SwuUIwO+81eXELlxyMfWwf3RL6dsA8gK22iUl/huFb
vbCbdQS/xRQMuH+oUUCfHqi6z4dGO1rRtVMyjUQXWvvw/mTqDeipU43o1QL2XeJi
5SRr+ldsxhc39W2ifNyOv2O6U8WhhTfg1KPBABpeClxmCOI4WD2cUjUcvvfIVP9+
SHjUBJbmVwdV7TafUSLMR60LuoV3rny9WAXMVbL7I2/XjLhdtn5vQnmRCkw/4bMC
vwIDAQAB
-----END PUBLIC KEY-----`

func TestEncode2Base64ByAppinfo(t *testing.T) {
	type args struct {
		appinfo       string
		rsaPrivateKey io.Reader
	}
	tests := []struct {
		name    string
		args    args
		want    string
		wantErr bool
	}{
		// TODO: Add test cases.
		{
			name: "Test Case 1",
			args: args{
				appinfo: `{
					"appname": "go-example",
					"appcompany": "TheOne",
					"appuuid": "12345678-1234-1234-1234-123456789012",
					"objuuid": "12345678-1234-1234-1234-123456789012",
					"authorized_name": "TheOne",
					"limited_time": "2021-01-01 00:00:00"
				}`,
				rsaPrivateKey: bytes.NewBufferString(okPrivateKey),
			},
			want:    "W3sicyI6MjU2LCJkIjoiMzIxM2Y5MzVlZDQyMmY5MDExOTljYmQ3ZGI4YjgzZDJmNjlhNDAyMzU2YTY2MTA2MDQ0YzU2ZGQ2NzE1ZjdjZGQyNzA0Zjc2NzA4ODdkYTdlYjViMzQzMGY2NDg0YTRlZjgwN2E1Yjc3YWU1YTY5NmU3OWZkZTBiMGQ2ZjhjMmIzMGFlZDEwYmVhNjdkNjU4M2QzZTA5MTNmYjFmMzk0MDE5NjgyNTUxMWRiMTIxMTVlOTU4MmFiYWIxZDQ0YzIzNDc4NTdmNDA3YTZjN2Y0ZDEzODNlOGNkOWEyMTM4MDNjYjZjZTEzNGRiOTIxNThkNTZlMjIzOTFmM2FjMzRjNDk2MzFjM2MxOGUzYmZlNTZjNTI4NThiZmQxY2U2NmRmMmJiNjlkZjQxY2I2YWE0NGI4NzI2OTVmYzY3YTg2ZmI5OTM0MGFmNjMwZmQzNGQxOTFlZjI3YWJkMzUzNzdmYzA2YTQyNzBlYTg3NTEyNjkyNmU1OTk4ZTU4ZDNkOWMxYTY1YzI0NTlmYTFiNGZiNjFhODk1ZTZlODM5NjhkYzljNTM5Mjk0ZDA3ZTU4OGVlY2U2OTVlYWM4Y2ZiMzliZTE0NGM4MWMzMjMxMGEzNjI2ZTc2MzZiYjk0ZjNhYjM4NTZiMzE1MTc4OWQwYmQyMjcxODQ4NDlkNzY2MDJjYzEifSx7InMiOjI1NiwiZCI6IjdkMDM4YTk2NmJiZDc2YzljZjQxMjZlMDNmMmMwYmZkYjI5OTA1ZWJiMmUxYWQ2ZGVlYmU5OWUwZmRlNzE0YjkzNWQ2YzZlMzc1NjhkODFhNTUyMTg4ODBjNTllMmRmMTc0MmIyNDI3MDJkM2I4OGRmN2M3MzE1NjE1NTk0OTIyNzJjYTc3NDJlOWEwNTdhYmFiODU4ZjYxN2RmZTc4ZWI5Mzc0ZTE3YzM4YTA5NjBjNzBkMzcxZjEzYTkyNDM5M2ExNWJkNmY0OWUwOWYwZDhmYjU0NDUwNjIyMjU4NTRmMTI1NTE3NTc3MDhjODU1Y2YxYTdkNmEzYWUyZjg4MmQ3OWRkNmYzMjZlZTQ3NDc2OTMzZjUwMzU1MzRjZjcwNTA5MTdmM2M1NGMxODc0NjcxNGRkMDA5MGRlMGE2MWRlNjliNmM2NTM1NWYwODYxZTBkYTRmMDIzNTBkNTRjYmY0YmZjOWQzODYyZjY0MGY0NGIxZDI2ZDhlNDMxNmYxOWQyYzZkNDUyY2RkZmNmODI3NTllNDU3ZmNiZDkyNDE5YzY0YWM5ZTFmM2E2YjU5YzAxMGIxOGJhMWRhYzYxZWM3Nzg0NmY1M2Q5ZGI4YzcxOWNkZTY2M2UzM2RkZmQ2MmQ3ZGQ0M2VhMGRhZTNkNzAyMzkxMDgwOGQ3MzI5YWQwIn0seyJzIjoyNTYsImQiOiI4OWU0OTFhNGVkODE5YzZlYWMwMDIzODkzYmJlMjVlZGUzYWRmOTBhMThmY2E3ODZkY2RjMGNhODkwNzIyZWFlMDc0NzhlYWU5NGFlNzNhMmQxOWY0MTA4MGNiMjZjMTM5MjQ5YjllY2U1ODJjOWIzMjBhOGExNDY1ZWE4NDQwYTYyMGM2NmM4NDk0N2NjZGViNzY4OTJkMTZkMjgzMTEzMzUzNjFhNGU1MzllZTEwZDViYjZkZWE0NTQ0NjkwODFkYTU1YzFmYTA5OWQ0NjZlYTgzN2UyOWY1YjRmOWZkNWMyNzQxZjJiODFkYTZiYjY3Mzg0YzkzZjMwNGNiNDYyMzI3MmE3ZTljYjdmMTFmMmJkMGU5MDY4OTFmOTJlN2VlYzg3MDI5ZDRiOWJmMGRkNDRmMjNlMGE5NGExMTU0YjA0NGIwMmRlZDM3MDRhZWU5NGI5ZmE0OTcxMDRlMDk5NzFjM2Y4MDMyYWU5YmRhYTIzNTkyYjU2NGRiZWYwMWNkMmVhZmE4ODJlMTc1NjM3MTYwZDYxNGIyZmZhN2VlMzUwMzlkN2IwMGJiN2ZmYTUwYWJkYmQ1MDQ1ODU2NWE3Mjk1ODY2MzcyNmFkNmIzMDU3NGE0NTIwZGNjODgxZWM0YmIxNmMyMTRlZTM0ZDhjMmI1ZTYwMGE1MDAyOWE4MCJ9LHsicyI6MjU2LCJkIjoiMGZkOGZiYTdlMTI3NTlmMjM3YmFjOTg5NDVmZjc4NjZjNDliOWI5YzRmY2U3MTdlMTE3ZDQwYWQ1Y2U4YjA0NmE0MWM0MjQyM2E0MjdjNmY0ZmI2NTFkNDM4NTZhMzZmY2Q2N2IxYTYwYTEwMTMyOTYxZTc4YjIyMTZjOGJkNGI4ZWQxM2Y5M2IyNDNkNGVlZDY0ZDVkNmY3MTZhYzllMzUwODE3YzU3YzQ2OWVlMTc2ZmRkZDQ1Njk2OGJiNTZkMzBlNzM2ZmUzN2Q5OWFkNzM5MDYwNGFjYTU2YTNiMWRiMGJkOGNkZmY4ZmYxYTRjZDYwYmE4N2M1N2Q4YjQ5ZTRlNDAyMjEwY2IyMzg0ZmY1MGRiNGIwNmRiZDJmYThmNGZiNzZmMzYzMjU0OTkxZGQ2YjIwZjgxNDI2YWE3OTEyMGFiNjBiMTk4MDc4YzRlNjg0MDE3ZWE5M2U5Y2EwNWY3ZTRhMTkwZDkzOGMxYTk2NTk2ZWYwNTQxOGViYWIyOTQ5MmIxYzQ5MDc2ZTZhMGZjMTBhMjAzOTJkMTAxZTI4YmNkYTg0MzcwNmM0YjNhMWUzMWE4OTEyYjc1Y2NmMzUyZGIzOWY5ZTk4NTcwODE4OTYzMGJjM2U0OWQ4MjgyZGJiNzgyYTJkMGZmOWFhMTAyOTZiMWM3YzYzODhiYTQifV0",
			wantErr: false,
		}, {
			name: "Test Case 2",
			args: args{
				appinfo: `{
					"appname": "go-example",
					"appcompany": "TheOne",
					"appuuid": "12345678-1234-1234-1234-123456789012",
					"objuuid": "12345678-1234-1234-1234-123456789012",
					"authorized_name": "TheOne",
					"limited_time": "2021-01-01 00:00:00"
				}`,
				rsaPrivateKey: bytes.NewBufferString("abc"),
			},
			want:    "",
			wantErr: true,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			got, err := Encode2Base64(strings.NewReader(tt.args.appinfo), tt.args.rsaPrivateKey)
			if (err != nil) != tt.wantErr {
				t.Errorf("Encode2Base64ByAppinfo() error = %v, wantErr %v", err, tt.wantErr)
			} else if tt.want != got {
				t.Errorf("Encode2Base64ByAppinfo() got = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestDecodeFromBase64ToAppinfo(t *testing.T) {
	type args struct {
		appinfo       string
		rsaPrivateKey io.Reader
	}
	tests := []struct {
		name    string
		args    args
		want    AppLicenseInfo
		wantErr bool
	}{
		// TODO: Add test cases.
		{
			name: "Test Case 1",
			args: args{
				appinfo:       `W3sicyI6MjU2LCJkIjoiMzIxM2Y5MzVlZDQyMmY5MDExOTljYmQ3ZGI4YjgzZDJmNjlhNDAyMzU2YTY2MTA2MDQ0YzU2ZGQ2NzE1ZjdjZGQyNzA0Zjc2NzA4ODdkYTdlYjViMzQzMGY2NDg0YTRlZjgwN2E1Yjc3YWU1YTY5NmU3OWZkZTBiMGQ2ZjhjMmIzMGFlZDEwYmVhNjdkNjU4M2QzZTA5MTNmYjFmMzk0MDE5NjgyNTUxMWRiMTIxMTVlOTU4MmFiYWIxZDQ0YzIzNDc4NTdmNDA3YTZjN2Y0ZDEzODNlOGNkOWEyMTM4MDNjYjZjZTEzNGRiOTIxNThkNTZlMjIzOTFmM2FjMzRjNDk2MzFjM2MxOGUzYmZlNTZjNTI4NThiZmQxY2U2NmRmMmJiNjlkZjQxY2I2YWE0NGI4NzI2OTVmYzY3YTg2ZmI5OTM0MGFmNjMwZmQzNGQxOTFlZjI3YWJkMzUzNzdmYzA2YTQyNzBlYTg3NTEyNjkyNmU1OTk4ZTU4ZDNkOWMxYTY1YzI0NTlmYTFiNGZiNjFhODk1ZTZlODM5NjhkYzljNTM5Mjk0ZDA3ZTU4OGVlY2U2OTVlYWM4Y2ZiMzliZTE0NGM4MWMzMjMxMGEzNjI2ZTc2MzZiYjk0ZjNhYjM4NTZiMzE1MTc4OWQwYmQyMjcxODQ4NDlkNzY2MDJjYzEifSx7InMiOjI1NiwiZCI6IjdkMDM4YTk2NmJiZDc2YzljZjQxMjZlMDNmMmMwYmZkYjI5OTA1ZWJiMmUxYWQ2ZGVlYmU5OWUwZmRlNzE0YjkzNWQ2YzZlMzc1NjhkODFhNTUyMTg4ODBjNTllMmRmMTc0MmIyNDI3MDJkM2I4OGRmN2M3MzE1NjE1NTk0OTIyNzJjYTc3NDJlOWEwNTdhYmFiODU4ZjYxN2RmZTc4ZWI5Mzc0ZTE3YzM4YTA5NjBjNzBkMzcxZjEzYTkyNDM5M2ExNWJkNmY0OWUwOWYwZDhmYjU0NDUwNjIyMjU4NTRmMTI1NTE3NTc3MDhjODU1Y2YxYTdkNmEzYWUyZjg4MmQ3OWRkNmYzMjZlZTQ3NDc2OTMzZjUwMzU1MzRjZjcwNTA5MTdmM2M1NGMxODc0NjcxNGRkMDA5MGRlMGE2MWRlNjliNmM2NTM1NWYwODYxZTBkYTRmMDIzNTBkNTRjYmY0YmZjOWQzODYyZjY0MGY0NGIxZDI2ZDhlNDMxNmYxOWQyYzZkNDUyY2RkZmNmODI3NTllNDU3ZmNiZDkyNDE5YzY0YWM5ZTFmM2E2YjU5YzAxMGIxOGJhMWRhYzYxZWM3Nzg0NmY1M2Q5ZGI4YzcxOWNkZTY2M2UzM2RkZmQ2MmQ3ZGQ0M2VhMGRhZTNkNzAyMzkxMDgwOGQ3MzI5YWQwIn0seyJzIjoyNTYsImQiOiI4OWU0OTFhNGVkODE5YzZlYWMwMDIzODkzYmJlMjVlZGUzYWRmOTBhMThmY2E3ODZkY2RjMGNhODkwNzIyZWFlMDc0NzhlYWU5NGFlNzNhMmQxOWY0MTA4MGNiMjZjMTM5MjQ5YjllY2U1ODJjOWIzMjBhOGExNDY1ZWE4NDQwYTYyMGM2NmM4NDk0N2NjZGViNzY4OTJkMTZkMjgzMTEzMzUzNjFhNGU1MzllZTEwZDViYjZkZWE0NTQ0NjkwODFkYTU1YzFmYTA5OWQ0NjZlYTgzN2UyOWY1YjRmOWZkNWMyNzQxZjJiODFkYTZiYjY3Mzg0YzkzZjMwNGNiNDYyMzI3MmE3ZTljYjdmMTFmMmJkMGU5MDY4OTFmOTJlN2VlYzg3MDI5ZDRiOWJmMGRkNDRmMjNlMGE5NGExMTU0YjA0NGIwMmRlZDM3MDRhZWU5NGI5ZmE0OTcxMDRlMDk5NzFjM2Y4MDMyYWU5YmRhYTIzNTkyYjU2NGRiZWYwMWNkMmVhZmE4ODJlMTc1NjM3MTYwZDYxNGIyZmZhN2VlMzUwMzlkN2IwMGJiN2ZmYTUwYWJkYmQ1MDQ1ODU2NWE3Mjk1ODY2MzcyNmFkNmIzMDU3NGE0NTIwZGNjODgxZWM0YmIxNmMyMTRlZTM0ZDhjMmI1ZTYwMGE1MDAyOWE4MCJ9LHsicyI6MjU2LCJkIjoiMGZkOGZiYTdlMTI3NTlmMjM3YmFjOTg5NDVmZjc4NjZjNDliOWI5YzRmY2U3MTdlMTE3ZDQwYWQ1Y2U4YjA0NmE0MWM0MjQyM2E0MjdjNmY0ZmI2NTFkNDM4NTZhMzZmY2Q2N2IxYTYwYTEwMTMyOTYxZTc4YjIyMTZjOGJkNGI4ZWQxM2Y5M2IyNDNkNGVlZDY0ZDVkNmY3MTZhYzllMzUwODE3YzU3YzQ2OWVlMTc2ZmRkZDQ1Njk2OGJiNTZkMzBlNzM2ZmUzN2Q5OWFkNzM5MDYwNGFjYTU2YTNiMWRiMGJkOGNkZmY4ZmYxYTRjZDYwYmE4N2M1N2Q4YjQ5ZTRlNDAyMjEwY2IyMzg0ZmY1MGRiNGIwNmRiZDJmYThmNGZiNzZmMzYzMjU0OTkxZGQ2YjIwZjgxNDI2YWE3OTEyMGFiNjBiMTk4MDc4YzRlNjg0MDE3ZWE5M2U5Y2EwNWY3ZTRhMTkwZDkzOGMxYTk2NTk2ZWYwNTQxOGViYWIyOTQ5MmIxYzQ5MDc2ZTZhMGZjMTBhMjAzOTJkMTAxZTI4YmNkYTg0MzcwNmM0YjNhMWUzMWE4OTEyYjc1Y2NmMzUyZGIzOWY5ZTk4NTcwODE4OTYzMGJjM2U0OWQ4MjgyZGJiNzgyYTJkMGZmOWFhMTAyOTZiMWM3YzYzODhiYTQifV0`,
				rsaPrivateKey: bytes.NewBufferString(okPubKey),
			},
			want: AppLicenseInfo{
				AppName:        "go-example",
				AppCompany:     "TheOne",
				AppUUID:        "12345678-1234-1234-1234-123456789012",
				ObjUUID:        "12345678-1234-1234-1234-123456789012",
				AuthorizedName: "TheOne",
				LimitedTime:    "2021-01-01 00:00:00",
			},
			wantErr: false,
		}, {
			name: "Test Case 2",
			args: args{
				appinfo:       `W3sicyI6MjU2LCJkIjoiMzIxM2Y5MzVlZDQyMmY5MDExOTljYmQ3ZGI4YjgzZDJmNjlhNDAyMzU2YTY2MTA2MDQ0YzU2ZGQ2NzE1ZjdjZGQyNzA0Zjc2NzA4ODdkYTdlYjViMzQzMGY2NDg0YTRlZjgwN2E1Yjc3YWU1YTY5NmU3OWZkZTBiMGQ2ZjhjMmIzMGFlZDEwYmVhNjdkNjU4M2QzZTA5MTNmYjFmMzk0MDE5NjgyNTUxMWRiMTIxMTVlOTU4MmFiYWIxZDQ0YzIzNDc4NTdmNDA3YTZjN2Y0ZDEzODNlOGNkOWEyMTM4MDNjYjZjZTEzNGRiOTIxNThkNTZlMjIzOTFmM2FjMzRjNDk2MzFjM2MxOGUzYmZlNTZjNTI4NThiZmQxY2U2NmRmMmJiNjlkZjQxY2I2YWE0NGI4NzI2OTVmYzY3YTg2ZmI5OTM0MGFmNjMwZmQzNGQxOTFlZjI3YWJkMzUzNzdmYzA2YTQyNzBlYTg3NTEyNjkyNmU1OTk4ZTU4ZDNkOWMxYTY1YzI0NTlmYTFiNGZiNjFhODk1ZTZlODM5NjhkYzljNTM5Mjk0ZDA3ZTU4OGVlY2U2OTVlYWM4Y2ZiMzliZTE0NGM4MWMzMjMxMGEzNjI2ZTc2MzZiYjk0ZjNhYjM4NTZiMzE1MTc4OWQwYmQyMjcxODQ4NDlkNzY2MDJjYzEifSx7InMiOjI1NiwiZCI6IjdkMDM4YTk2NmJiZDc2YzljZjQxMjZlMDNmMmMwYmZkYjI5OTA1ZWJiMmUxYWQ2ZGVlYmU5OWUwZmRlNzE0YjkzNWQ2YzZlMzc1NjhkODFhNTUyMTg4ODBjNTllMmRmMTc0MmIyNDI3MDJkM2I4OGRmN2M3MzE1NjE1NTk0OTIyNzJjYTc3NDJlOWEwNTdhYmFiODU4ZjYxN2RmZTc4ZWI5Mzc0ZTE3YzM4YTA5NjBjNzBkMzcxZjEzYTkyNDM5M2ExNWJkNmY0OWUwOWYwZDhmYjU0NDUwNjIyMjU4NTRmMTI1NTE3NTc3MDhjODU1Y2YxYTdkNmEzYWUyZjg4MmQ3OWRkNmYzMjZlZTQ3NDc2OTMzZjUwMzU1MzRjZjcwNTA5MTdmM2M1NGMxODc0NjcxNGRkMDA5MGRlMGE2MWRlNjliNmM2NTM1NWYwODYxZTBkYTRmMDIzNTBkNTRjYmY0YmZjOWQzODYyZjY0MGY0NGIxZDI2ZDhlNDMxNmYxOWQyYzZkNDUyY2RkZmNmODI3NTllNDU3ZmNiZDkyNDE5YzY0YWM5ZTFmM2E2YjU5YzAxMGIxOGJhMWRhYzYxZWM3Nzg0NmY1M2Q5ZGI4YzcxOWNkZTY2M2UzM2RkZmQ2MmQ3ZGQ0M2VhMGRhZTNkNzAyMzkxMDgwOGQ3MzI5YWQwIn0seyJzIjoyNTYsImQiOiI4OWU0OTFhNGVkODE5YzZlYWMwMDIzODkzYmJlMjVlZGUzYWRmOTBhMThmY2E3ODZkY2RjMGNhODkwNzIyZWFlMDc0NzhlYWU5NGFlNzNhMmQxOWY0MTA4MGNiMjZjMTM5MjQ5YjllY2U1ODJjOWIzMjBhOGExNDY1ZWE4NDQwYTYyMGM2NmM4NDk0N2NjZGViNzY4OTJkMTZkMjgzMTEzMzUzNjFhNGU1MzllZTEwZDViYjZkZWE0NTQ0NjkwODFkYTU1YzFmYTA5OWQ0NjZlYTgzN2UyOWY1YjRmOWZkNWMyNzQxZjJiODFkYTZiYjY3Mzg0YzkzZjMwNGNiNDYyMzI3MmE3ZTljYjdmMTFmMmJkMGU5MDY4OTFmOTJlN2VlYzg3MDI5ZDRiOWJmMGRkNDRmMjNlMGE5NGExMTU0YjA0NGIwMmRlZDM3MDRhZWU5NGI5ZmE0OTcxMDRlMDk5NzFjM2Y4MDMyYWU5YmRhYTIzNTkyYjU2NGRiZWYwMWNkMmVhZmE4ODJlMTc1NjM3MTYwZDYxNGIyZmZhN2VlMzUwMzlkN2IwMGJiN2ZmYTUwYWJkYmQ1MDQ1ODU2NWE3Mjk1ODY2MzcyNmFkNmIzMDU3NGE0NTIwZGNjODgxZWM0YmIxNmMyMTRlZTM0ZDhjMmI1ZTYwMGE1MDAyOWE4MCJ9LHsicyI6MjU2LCJkIjoiMGZkOGZiYTdlMTI3NTlmMjM3YmFjOTg5NDVmZjc4NjZjNDliOWI5YzRmY2U3MTdlMTE3ZDQwYWQ1Y2U4YjA0NmE0MWM0MjQyM2E0MjdjNmY0ZmI2NTFkNDM4NTZhMzZmY2Q2N2IxYTYwYTEwMTMyOTYxZTc4YjIyMTZjOGJkNGI4ZWQxM2Y5M2IyNDNkNGVlZDY0ZDVkNmY3MTZhYzllMzUwODE3YzU3YzQ2OWVlMTc2ZmRkZDQ1Njk2OGJiNTZkMzBlNzM2ZmUzN2Q5OWFkNzM5MDYwNGFjYTU2YTNiMWRiMGJkOGNkZmY4ZmYxYTRjZDYwYmE4N2M1N2Q4YjQ5ZTRlNDAyMjEwY2IyMzg0ZmY1MGRiNGIwNmRiZDJmYThmNGZiNzZmMzYzMjU0OTkxZGQ2YjIwZjgxNDI2YWE3OTEyMGFiNjBiMTk4MDc4YzRlNjg0MDE3ZWE5M2U5Y2EwNWY3ZTRhMTkwZDkzOGMxYTk2NTk2ZWYwNTQxOGViYWIyOTQ5MmIxYzQ5MDc2ZTZhMGZjMTBhMjAzOTJkMTAxZTI4YmNkYTg0MzcwNmM0YjNhMWUzMWE4OTEyYjc1Y2NmMzUyZGIzOWY5ZTk4NTcwODE4OTYzMGJjM2U0OWQ4MjgyZGJiNzgyYTJkMGZmOWFhMTAyOTZiMWM3YzYzODhiYTQifV0`,
				rsaPrivateKey: bytes.NewBufferString("abc"),
			},
			want:    AppLicenseInfo{},
			wantErr: true,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			got, err := DecodeFromBase64ToAppinfo(strings.NewReader(tt.args.appinfo), tt.args.rsaPrivateKey)
			if (err != nil) != tt.wantErr {
				t.Errorf("DecodeFromBase64ToAppinfo() error = %v, wantErr %v", err, tt.wantErr)
			} else if !reflect.DeepEqual(got, tt.want) {
				t.Errorf("DecodeFromBase64ToAppinfo() got = %v, want %v", got, tt.want)
			}
		})
	}
}
